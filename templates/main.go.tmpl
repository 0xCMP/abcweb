package main

import (
	"{{.ImportPath}}/app"
	"{{.ImportPath}}/config"
	"{{.ImportPath}}/db"
	"{{.ImportPath}}/rendering"
	"go.uber.org/zap"
)

// These are set by the linker when running the "abcweb build" command.
var version = "unknown"
var buildTime = "unknown"

func main() {
	// Display the version hash and build time
	args := os.Args
	if len(args) == 2 && args[1] == "--version" {
		fmt.Println(fmt.Sprintf("version %q, built %s", version, buildTime))
		return
	}
	
	state := &app.State{}

	// Setup the main app (root command)
	rootSetup(state)

	// Setup and bind the migrate command
	migrateSetup(state)

	if err := state.Root.Execute(); err != nil {
		state.Log.Fatal("root command execution failed", zap.Error(err))
	}
}

